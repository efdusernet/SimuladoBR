<!doctype html>
<html lang="pt-BR">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>SimuladosBR — Login</title>
  
  <!-- PWA Meta Tags -->
  <meta name="description" content="Simulados completos para certificação PMP com questões reais e indicadores detalhados">
  <meta name="theme-color" content="#4f46e5">
  <meta name="mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
  <meta name="apple-mobile-web-app-title" content="SimuladosBR">
  
  <!-- PWA Manifest -->
  <link rel="manifest" href="/manifest.json">
  <link rel="apple-touch-icon" href="/assets/icon-192.png">
  <link rel="icon" type="image/png" sizes="192x192" href="/assets/icon-192.png">
  
  <!-- Prefer CSS minificado em dist quando disponível; mantém original como fallback -->
  <link rel="stylesheet" href="./dist/styles.css">
  <link rel="stylesheet" href="./styles.css">
  
  <!-- Controlled Logging System (must load before other scripts) -->
  <script src="/utils/logger.js"></script>

  <!-- CSRF Protection -->
  <script src="/utils/csrf.js"></script>
  <style>
    /* Modern login page styling */
    :root {
      --bg: #0f172a;
      --panel: #ffffff;
      --panel-border: #e2e8f0;
      --primary: #4f46e5;
      --primary-600: #4338ca;
      --text: #0f172a;
      --muted: #64748b;
      --success: #16a34a;
      --danger: #dc2626;
    }
    body { margin:0; background: radial-gradient(1000px 480px at 10% -10%, #1d2a49 0%, #0f172a 40%, #0b132b 100%); color: var(--text); min-height: 100vh; display:flex; align-items:center; justify-content:center; padding: 24px; }
    .login-wrap { width:100%; max-width: 420px; }
    .brand { display:flex; align-items:center; gap:10px; justify-content:center; color:#fff; margin-bottom:14px; }
    .brand-logo { width:36px; height:36px; border-radius:10px; background: linear-gradient(135deg, var(--primary), var(--primary-600)); display:flex; align-items:center; justify-content:center; box-shadow: 0 8px 18px rgba(79,70,229,.35); }
    .brand-title { font-weight:800; letter-spacing:.3px; }
    .panel { background: var(--panel); border:1px solid var(--panel-border); border-radius: 16px; box-shadow: 0 12px 30px rgba(0,0,0,.14); overflow:hidden; }
    .panel-header { background: linear-gradient(135deg, var(--primary), var(--primary-600)); color:#fff; padding: 16px 18px; }
    .panel-header h1 { margin:0; font-size: 1rem; letter-spacing:.5px; }
    .panel-body { padding: 16px 18px; }
    .panel-body .input { width: 100%; max-width: 100%; }
    .field { display:flex; flex-direction:column; gap:6px; margin-bottom: 12px; }
    .field label { font-size: .8rem; font-weight: 700; color: var(--text); }
    .input { border:1px solid var(--panel-border); border-radius: 10px; padding: 10px 12px; font-size: .95rem; outline:none; transition: border .2s, box-shadow .2s; width:100%; max-width:100%; box-sizing:border-box; }
    .input:focus { border-color: var(--primary); box-shadow: 0 0 0 3px rgba(79,70,229,.15); }
    .actions { display:flex; gap:10px; align-items:center; margin-top: 8px; }
    .btn { appearance:none; border:none; cursor:pointer; padding: 10px 12px; border-radius: 10px; font-weight:700; letter-spacing:.3px; }
    .btn.primary { background: var(--primary); color:#fff; box-shadow: 0 8px 18px rgba(79,70,229,.35); }
    .btn.primary:hover { background: var(--primary-600); }
    .btn.secondary { background:#eef2ff; color: var(--primary); border:1px solid #c7d2fe; }
    .links { display:flex; justify-content:space-between; align-items:center; margin-top: 8px; }
    .link { color: var(--primary); font-weight:700; text-decoration:none; font-size:.9rem; }
    .error { color: var(--danger); font-size:.9rem; margin-top: 8px; display:none; }
    .success { color: var(--success); font-size:.9rem; margin-top: 8px; display:none; }
    .footer { text-align:center; margin-top: 14px; color: #e2e8f0; font-size: .8rem; }
    /* Disable legacy modal overlay entirely on this page */
    .modal, #emailModal { display: none !important; }
  </style>
</head>
<body>
  <div class="login-wrap">
    <div class="brand" aria-label="SimuladosBR">
      <div class="brand-logo" aria-hidden="true">
        <img src="/assets/icon-192.png" alt="" style="width:22px;height:22px;border-radius:6px;" />
      </div>
      <div class="brand-title">SimuladosBR</div>
    </div>
    <div class="panel" role="dialog" aria-labelledby="loginTitle">
      <div class="panel-header">
        <h1 id="loginTitle">Entrar na sua conta</h1>
      </div>
      <div class="panel-body">
        <div class="field" id="nameField" style="display:none;">
          <label for="nameInput">Nome completo</label>
          <input id="nameInput" type="text" class="input" placeholder="Seu nome completo" />
        </div>
        <div class="field">
          <label for="emailInput">E-mail</label>
          <input id="emailInput" type="email" class="input" placeholder="seu@exemplo.com" />
        </div>
        <div class="field" id="passwordField">
          <label for="passwordInput">Senha</label>
          <input id="passwordInput" type="password" class="input" placeholder="Senha (mínimo 6 caracteres)" />
        </div>
        <div class="field" id="verifyTokenField" style="display:none;">
          <label for="verifyTokenInput">Código de verificação</label>
          <input id="verifyTokenInput" type="text" class="input" placeholder="Código recebido por e-mail" />
        </div>
        <div class="field" id="newPasswordField" style="display:none;">
          <label for="newPasswordInput">Nova senha</label>
          <input id="newPasswordInput" type="password" class="input" placeholder="Nova senha (mínimo 6 caracteres)" />
        </div>
        <div class="field" id="confirmPasswordField" style="display:none;">
          <label for="confirmPasswordInput">Confirmar nova senha</label>
          <input id="confirmPasswordInput" type="password" class="input" placeholder="Confirmar nova senha" />
        </div>
        <div class="actions">
          <button id="submitEmail" class="btn primary">Entrar</button>
          <button id="toggleModeBtn" type="button" class="btn secondary">Criar conta</button>
        </div>
        <div class="links">
          <a id="forgotPasswordLink" href="#" class="link">Esqueci minha senha</a>
          <a href="/" class="link" aria-label="Voltar ao início">Voltar</a>
        </div>
        <p id="modalError" class="error"></p>
        <p id="modalSuccess" class="success"></p>
      </div>
    </div>
    <div class="footer">© SimuladosBR — Estude melhor, aprove melhor.</div>
  </div>

  <!-- Legacy modal container kept (empty) for compatibility; content removed -->
  <div id="emailModal" class="modal" aria-hidden="true" style="display:none;"></div>

  <!-- DOMPurify for XSS protection -->
  <script src="https://cdn.jsdelivr.net/npm/dompurify@3.0.6/dist/purify.min.js"></script>
  <!-- Sanitization utilities -->
  <script src="./utils/sanitize.js"></script>
  <script src="./script.js" defer></script>
</body>
</html>
